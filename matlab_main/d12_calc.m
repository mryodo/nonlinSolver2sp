function res=d12_calc(D12, D11, D22, m1, m2, w11, w12, w21, w22, b1, b2, d1, d2, d11, d12, d21, d22, N1, N2, al, A, N, dim, I, J)
    left=((1-al/2)*(b1+b2)+al/2*(d1+d2+N1*(d11+d21)+N2*(d12+d22)))*ones(1,N)+w12+w21;
    right=conv_dim(m1+m2, D12, N, A, dim, I, J)-...
    al/2*N1*((D12+2*ones(1,N)).*(conv_dim(w11, D12, N, A, dim, I, J)+conv_dim(w21, D11, N, A, dim, I, J))+...
    conv_dim(w21.*D12, D11, N, A, dim, I, J)+conv_dim(w11.*D11, D12, N, A, dim, I, J))-...
    al/2*N2*((D12+2*ones(1,N)).*(conv_dim(w12, D22, N, A, dim, I, J)+conv_dim(w22, D12, N, A, dim, I, J))+...
    conv_dim(w22.*D22, D12, N, A, dim, I, J)+conv_dim(w12.*D12, D22, N, A, dim, I, J));
    right=right-w12-w21;
    res=right./left;
end