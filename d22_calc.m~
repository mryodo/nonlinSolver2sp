function res=d22_calc(D22, D21, m2, w22, w21, b2, d2, d22, d21, N2, N1, al, A, N, dim, I, J)
    left=((1-al/2)*b2+al/2*(d2+N1*d21+N2*d22))*ones(1,N)+w22;
    right=conv_dim(m2, D22, N, A, dim, I, J)-...
    al/2*N2*((D22+2*ones(1,N)).*conv_dim(w22, D22, N, A, dim, I, J)+...
    conv_dim(w22.*D22, D22, N, A, dim, I, J))-...
    al/2*N1*((D22+2*ones(1,N)).*conv_dim(w21, D21, N, A, dim, I, J)+...
    conv_dim(w21.*D21, D21, N, A, dim, I, J));
    right=right+(1/N2)*m2-w22;
    res=right./left;
end